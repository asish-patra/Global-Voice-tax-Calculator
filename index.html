<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Global Voice Calculator â€” Demo</title>
  <style>
    :root{--bg:#f6f8fb;--card:#fff;--accent:#1473e6;--muted:#6b7280}
    body{font-family:Inter,system-ui,Arial,sans-serif;background:var(--bg);margin:0;color:#0f172a}
    .container{max-width:980px;margin:32px auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#0ea5a2);display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(14,22,46,0.06)}
    .controls{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:12px}
    select,input[type="checkbox"]{padding:8px 10px;border-radius:8px;border:1px solid #e6eef8}
    .mic-btn{width:84px;height:84px;border-radius:999px;border:none;background:linear-gradient(180deg,#ff4d4f,#ff6b6b);display:flex;align-items:center;justify-content:center;color:white;font-size:18px;cursor:pointer;box-shadow:0 8px 20px rgba(255,77,79,0.18)}
    .mic-on{background:linear-gradient(180deg,#0ea5a2,#1473e6)}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:16px}
    .transcript{min-height:160px;padding:12px;border-radius:10px;border:1px dashed #e6eef8;background:#fbfdff;white-space:pre-wrap}
    .result{padding:12px;border-radius:10px;background:#fbfbff}
    button.btn{padding:10px 12px;border-radius:8px;border:none;background:var(--accent);color:white;cursor:pointer}
    footer{margin-top:18px;color:var(--muted);font-size:13px}
    @media(max-width:880px){.grid{grid-template-columns:1fr} .controls{flex-direction:column}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">VC</div>
        <div>
          <h1 style="margin:0;font-size:18px">Global Voice Calculator</h1>
          <div style="font-size:13px;color:var(--muted)">Speak, calculate, translate & tax â€” instant demo</div>
        </div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <select id="ui-lang" title="UI language">
          <option value="en-US">UI: English (en-US)</option>
          <option value="hi-IN">UI: Hindi (hi-IN)</option>
          <option value="de-DE">UI: German (de-DE)</option>
          <option value="pt-BR">UI: Portuguese (pt-BR)</option>
          <option value="it-IT">UI: Italian (it-IT)</option>
          <option value="ru-RU">UI: Russian (ru-RU)</option>
          <option value="ar-SA">UI: Arabic (ar-SA)</option>
          <option value="fr-FR">UI: French (fr-FR)</option>
          <option value="es-ES">UI: Spanish (es-ES)</option>
          <option value="ja-JP">UI: Japanese (ja-JP)</option>
          <option value="zh-CN">UI: Chinese (zh-CN)</option>
          <option value="ko-KR">UI: Korean (ko-KR)</option>
          <option value="nl-NL">UI: Dutch (nl-NL)</option>
          <option value="sv-SE">UI: Swedish (sv-SE)</option>
          <option value="fi-FI">UI: Finnish (fi-FI)</option>
          <option value="pl-PL">UI: Polish (pl-PL)</option>
          <option value="tr-TR">UI: Turkish (tr-TR)</option>
          <option value="el-GR">UI: Greek (el-GR)</option>
          <option value="he-IL">UI: Hebrew (he-IL)</option>
            <option value="ar-EG">UI: Arabic (Egypt) (ar-EG)</option>
            <option value="ar-AE">UI: Arabic (UAE) (ar-AE)</option>
            <option value="ar-OM">UI: Arabic (Oman) (ar-OM)</option>
            <option value="ar-QA">UI: Arabic (Qatar) (ar-QA)</option>
            <option value="ar-KW">UI: Arabic (Kuwait) (ar-KW)</option>
            <option value="ar-BH">UI: Arabic (Bahrain) (ar-BH)</option>
            <option value="ar-JO">UI: Arabic (Jordan) (ar-JO)</option>
            <option value="ar-LB">UI: Arabic (Lebanon) (ar-LB)</option>
            <option value="ar-DZ">UI: Arabic (Algeria) (ar-DZ)</option>
            <option value="ar-MA">UI: Arabic (Morocco) (ar-MA)</option>
            <option value="ar-TN">UI: Arabic (Tunisia) (ar-TN)</option>
            <option value="ar-LY">UI: Arabic (Libya) (ar-LY)</option>
            <option value="ar-SY">UI: Arabic (Syria) (ar-SY)</option>
            <option value="ar-IQ">UI: Arabic (Iraq) (ar-IQ)</option>
            <option value="ar-YE">UI: Arabic (Yemen) (ar-YE)</option>
            <option value="ar-SD">UI: Arabic (Sudan) (ar-SD)</option>
        </select>
        <button id="translateBtn" class="btn">Translate</button>
      </div>
    </header>

    <div class="card">
      <div class="controls">
        <label>
          Input language:
          <select id="lang">
            <option value="auto">Auto Detect</option>
            <option value="en-US">English (en-US)</option>
            <option value="hi-IN">Hindi (hi-IN)</option>
            <option value="de-DE">German (de-DE)</option>
            <option value="pt-BR">Portuguese (pt-BR)</option>
            <option value="it-IT">Italian (it-IT)</option>
            <option value="ru-RU">Russian (ru-RU)</option>
            <option value="ar-SA">Arabic (ar-SA)</option>
            <option value="ko-KR">Korean (ko-KR)</option>
            <option value="nl-NL">Dutch (nl-NL)</option>
            <option value="sv-SE">Swedish (sv-SE)</option>
            <option value="fi-FI">Finnish (fi-FI)</option>
            <option value="pl-PL">Polish (pl-PL)</option>
            <option value="tr-TR">Turkish (tr-TR)</option>
            <option value="el-GR">Greek (el-GR)</option>
            <option value="he-IL">Hebrew (he-IL)</option>
            <option value="ar-EG">Arabic (Egypt) (ar-EG)</option>
            <option value="ar-AE">Arabic (UAE) (ar-AE)</option>
            <option value="ar-OM">Arabic (Oman) (ar-OM)</option>
            <option value="ar-QA">Arabic (Qatar) (ar-QA)</option>
            <option value="ar-KW">Arabic (Kuwait) (ar-KW)</option>
            <option value="ar-BH">Arabic (Bahrain) (ar-BH)</option>
            <option value="ar-JO">Arabic (Jordan) (ar-JO)</option>
            <option value="ar-LB">Arabic (Lebanon) (ar-LB)</option>
            <option value="ar-DZ">Arabic (Algeria) (ar-DZ)</option>
            <option value="ar-MA">Arabic (Morocco) (ar-MA)</option>
            <option value="ar-TN">Arabic (Tunisia) (ar-TN)</option>
            <option value="ar-LY">Arabic (Libya) (ar-LY)</option>
            <option value="ar-SY">Arabic (Syria) (ar-SY)</option>
            <option value="ar-IQ">Arabic (Iraq) (ar-IQ)</option>
            <option value="ar-YE">Arabic (Yemen) (ar-YE)</option>
            <option value="ar-SD">Arabic (Sudan) (ar-SD)</option>
            <option value="ar-MA">Arabic (Morocco) (ar-MA)</option>
            <option value="ar-PS">Arabic (Palestine) (ar-PS)</option>
            <option value="fr-FR">French (fr-FR)</option>
            <option value="es-ES">Spanish (es-ES)</option>
            <option value="ja-JP">Japanese (ja-JP)</option>
            <option value="zh-CN">Chinese (zh-CN)</option>
          </select>
        </label>

        <label>
          Country tax:
          <select id="country">
            <option value="IN" data-rate="0.18">India (GST 18%)</option>
            <option value="GB" data-rate="0.20">UK (VAT 20%)</option>
            <option value="CA" data-rate="0.05">Canada (GST 5%)</option>
            <option value="AU" data-rate="0.10">Australia (GST 10%)</option>
            <option value="JP" data-rate="0.10">Japan (Consumption tax 10%)</option>
            <option value="CN" data-rate="0.13">China (VAT 13   %)</option>
            <option value="BR" data-rate="0.17">Brazil (ICMS 17%)</option>
            <option value="MX" data-rate="0.16">Mexico (IVA 16%)</option>
            <option value="ZA" data-rate="0.15">South Africa (VAT 15%)</option>
            <option value="RU" data-rate="0.20">Russia (VAT 20%)</option>
            <option value="KR" data-rate="0.10">South Korea (VAT 10%)</option>
            <option value="SG" data-rate="0.07">Singapore (GST 7%)</option>
            <option value="CH" data-rate="0.077">Switzerland (VAT   7.7%)</option>
            <option value="AE" data-rate="0.05">UAE (VAT 5%)</option>
            <option value="NZ" data-rate="0.15">New Zealand (GST 15%)</option>
            <option value="IT" data-rate="0.22">Italy (VAT 22%)</option>
            <option value="ES" data-rate="0.21">Spain (VAT 21%)</option>
            <option value="NL" data-rate="0.21">Netherlands (VAT 21%)</option>
            <option value="SE" data-rate="0.25">Sweden (VAT 25%)</option>
            <option value="NO" data-rate="0.25">Norway (VAT 25%)</option>
            <option value="PL" data-rate="0.23">Poland (VAT 23%)</option>
            <option value="AT" data-rate="0.20">Austria (VAT 20%)</option>
            <option value="BE" data-rate="0.21">Belgium (VAT 21%)</option>
            <option value="DK" data-rate="0.25">Denmark (VAT 25%)</option>
            <option value="FI" data-rate="0.24">Finland (VAT 24%)</option>
            <option value="IE" data-rate="0.23">Ireland (VAT 23%)</option>
            <option value="PT" data-rate="0.23">Portugal (VAT 23%)</option>
            <option value="CZ" data-rate="0.21">Czech Republic (VAT 21%)</option>
            <option value="HU" data-rate="0.27">Hungary (VAT 27%)</option>
            <option value="GR" data-rate="0.24">Greece (VAT 24%)</option>
            <option value="RO" data-rate="0.19">Romania (VAT 19%)</option>
            <option value="TR" data-rate="0.18">Turkey (VAT 18%)</option>  
            <option value="US" data-rate="0.07">USA (avg sales 7%)</option>
            <option value="DE" data-rate="0.19">Germany (VAT 19%)</option>
            <option value="FR" data-rate="0.20">France (VAT 20%)</option>
            <option value="NONE" data-rate="0">No tax</option>
          </select>
        </label>

        <label style="display:flex;align-items:center;gap:8px">
          <input type="checkbox" id="includeTax" checked />
          Include tax
        </label>

        <label>
          Currency:
          <select id="currency">
            <option value="INR">INR</option>
            <option value="GBP">GBP</option>
            <option value="CAD">CAD</option>
            <option value="AUD">AUD</option>
            <option value="JPY">JPY</option>
            <option value="CNY">CNY</option>
            <option value="BRL">BRL</option>
            <option value="MXN">MXN</option>
            <option value="ZAR">ZAR</option>
            <option value="RUB">RUB</option>
            <option value="KRW">KRW</option>
            <option value="SGD">SGD</option>
            <option value="CHF">CHF</option>
            <option value="AED">AED</option>
            <option value="NZD">NZD</option>
            <option value="EUR">EUR</option>
            <option value="USD">USD</option>
            <option value="SEK">SEK</option>
            <option value="NOK">NOK</option>
            <option value="PLN">PLN</option>
            <option value="DKK">DKK</option>
            <option value="HUF">HUF</option>
            <option value="CZK">CZK</option>
            <option value="TRY">TRY</option>
            <option value="ILS">ILS</option>
            <option value="THB">THB</option>
            <option value="MYR">MYR</option>
            <option value="PHP">PHP</option>
            <option value="IDR">IDR</option>
            <option value="VND">VND</option>
            <option value="TWD">TWD</option>
            <option value="HKD">HKD</option>
            <option value="ARS">ARS</option>
            <option value="CLP">CLP</option>
            <option value="PEN">PEN</option>
            <option value="COP">COP</option>
            <option value="UYU">UYU</option>
            <option value="VEF">VEF</option>
            <option value="SAR">SAR</option>
            <option value="QAR">QAR</option>
            <option value="OMR">OMR</option>
            <option value="KWD">KWD</option>
            <option value="BHD">BHD</option>
            <option value="JOD">JOD</option>
            <option value="LYD">LYD</option>
            <option value="DZD">DZD</option>
            <option value="MAD">MAD</option>
            <option value="TND">TND</option>
            <option value="EGP">EGP</option>
            <option value="IQD">IQD</option>
            <option value="YER">YER</option>
            <option value="SDG">SDG</option>
            <option value="PKR">PKR</option>
            <option value="BDT">BDT</option>
            <option value="LKR">LKR</option>
            <option value="AFN">AFN</option>
            <option value="MMK">MMK</option>
            <option value="KHR">KHR</option>
            <option value="LAK">LAK</option>
            <option value="MNT">MNT</option>
            <option value="KZT">KZT</option>
            <option value="UZS">UZS</option>
            <option value="GEL">GEL</option>
            <option value="AZN">AZN</option>
            <option value="MDL">MDL</option>
            <option value="BYN">BYN</option>
            <option value="UAH">UAH</option>
            <option value="RSD">RSD</option>
            <option value="BGN">BGN</option>
            <option value="HRK">HRK</option>
            <option value="RON">RON</option>
        
          </select>
        </label>

        <div style="margin-left:auto;display:flex;gap:10px;align-items:center">
          <button id="clearBtn" class="btn" style="background:#6b7280">Clear</button>
        </div>
      </div>

      <div class="grid">
        <div>
          <div style="display:flex;gap:12px;align-items:center;margin-bottom:12px">
            <button id="mic" class="mic-btn" title="Start / Stop">
              ðŸŽ™
            </button>
            <div style="flex:1">
              <div style="font-size:13px;color:var(--muted)">Live transcript</div>
              <div id="transcript" class="transcript">Press the mic and speak e.g. "Add 500 and apply 18% tax" or "500 plus 10 percent"</div>
            </div>
          </div>

          <div style="display:flex;gap:8px">
            <button id="calcBtn" class="btn">Calculate</button>
            <button id="speakResult" class="btn" style="background:#0ea5a2">Speak Result</button>
            <!-- Placeholder: send to meeting caption -->
            <button id="sendCaption" class="btn" style="background:#9b8cff">Send to Meeting</button>
          </div>
        </div>

        <aside>
          <div style="font-size:13px;color:var(--muted);margin-bottom:8px">Result</div>
          <div class="result" id="resultBox">
            <div><strong>Base:</strong> <span id="baseAmt">â€”</span></div>
            <div><strong>Tax (%):</strong> <span id="taxPct">â€”</span></div>
            <div><strong>Tax Amount:</strong> <span id="taxAmt">â€”</span></div>
            <div style="margin-top:8px;font-size:18px"><strong>Total:</strong> <span id="totalAmt">â€”</span></div>
          </div>
        </aside>
      </div>
    </div>

    <footer>
      This demo uses the browser Web Speech API for quick testing. Replace with Google Cloud Speech-to-Text on the server for full multi-language accuracy and meeting integrations.
    </footer>
  </div>

  <script>
    // Basic demo logic: Web Speech, simple parse, apply country tax locally.
    const mic = document.getElementById('mic');
    const transcriptEl = document.getElementById('transcript');
    const langSelect = document.getElementById('lang');
    const calcBtn = document.getElementById('calcBtn');
    const includeTax = document.getElementById('includeTax');
    const countrySelect = document.getElementById('country');
    const currencySel = document.getElementById('currency');
    const baseAmtEl = document.getElementById('baseAmt');
    const taxPctEl = document.getElementById('taxPct');
    const taxAmtEl = document.getElementById('taxAmt');
    const totalAmtEl = document.getElementById('totalAmt');
    const clearBtn = document.getElementById('clearBtn');
    const speakBtn = document.getElementById('speakResult');
    let recognition, listening = false, lastTranscript='';

    // Setup Web Speech if available
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SR();
      recognition.interimResults = false;
      recognition.continuous = false;
      recognition.onresult = (e) => {
        const t = Array.from(e.results).map(r => r[0].transcript).join(' ');
        lastTranscript = t;
        transcriptEl.textContent = t;
      };
      recognition.onend = () => {
        listening = false;
        mic.classList.remove('mic-on');
      };
    } else {
      mic.disabled = true;
      mic.title = 'Speech API not supported in this browser';
    }

    mic.addEventListener('click', () => {
      if (!recognition) return alert('Speech API not supported in this browser (use Chrome).');
      if (!listening) {
        recognition.lang = (langSelect.value === 'auto') ? 'en-US' : langSelect.value;
        recognition.start();
        listening = true;
        mic.classList.add('mic-on');
        transcriptEl.textContent = 'Listening...';
      } else {
        recognition.stop();
        listening = false;
        mic.classList.remove('mic-on');
      }
    });

    clearBtn.addEventListener('click', ()=> {
      transcriptEl.textContent = 'Press the mic and speak e.g. "Add 500 and apply 18% tax"';
      lastTranscript = '';
      baseAmtEl.textContent = taxPctEl.textContent = taxAmtEl.textContent = totalAmtEl.textContent = 'â€”';
    });

    // Very simple parser: finds first number and first percent, supports "add" implicitly
    function parseExpression(text) {
      // find number with optional decimals
      const numMatch = text.replace(/,/g,'').match(/([0-9]+(\.[0-9]+)?)/);
      const pctMatch = text.match(/([0-9]+(\.[0-9]+)?)\s*%|percent|percent/);
      let amount = numMatch ? parseFloat(numMatch[0]) : null;
      // if user says two numbers (like "add 100 and 50"), add them
      const allNums = text.replace(/,/g,'').match(/([0-9]+(\.[0-9]+)?)/g);
      if (allNums && allNums.length > 1) {
        amount = allNums.map(n => parseFloat(n)).reduce((a,b)=>a+b,0);
      }
      let pct = null;
      if (pctMatch) {
        // extract actual numeric percent if present
        const p = text.match(/([0-9]+(\.[0-9]+)?)\s*%/);
        if (p) pct = parseFloat(p[1]) / 100;
      }
      return { amount, pct };
    }

    calcBtn.addEventListener('click', ()=> {
      const text = lastTranscript || transcriptEl.textContent || '';
      if (!text || text.includes('Press the mic')) return alert('Please speak an amount or type a phrase first.');
      const { amount, pct } = parseExpression(text.toLowerCase());
      if (amount == null) return alert('Could not detect an amount. Try saying "500" or "add 400 and 100".');

      // Determine tax
      const countryOpt = countrySelect.selectedOptions[0];
      const taxRate = parseFloat(countryOpt.dataset.rate) || 0;
      const useTax = includeTax.checked;
      const appliedPct = pct != null ? pct : (useTax ? taxRate : 0);

      const taxAmount = +(amount * appliedPct).toFixed(2);
      const total = +(amount + taxAmount).toFixed(2);

      baseAmtEl.textContent = `${amount.toLocaleString()} ${currencySel.value}`;
      taxPctEl.textContent = `${(appliedPct*100).toFixed(2)}%`;
      taxAmtEl.textContent = `${taxAmount.toLocaleString()} ${currencySel.value}`;
      totalAmtEl.textContent = `${total.toLocaleString()} ${currencySel.value}`;

      // Placeholder: instead of local calculation, you could send the transcript to your Laravel API:
      // fetch('/api/voice-calculate', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ transcript: text, country: countrySelect.value }) })
      //   .then(r=>r.json()).then(res => { /* update UI from server response */ });
    });

    // Speak result using Web Speech Synthesis
    speakBtn.addEventListener('click', ()=> {
      const total = totalAmtEl.textContent;
      if (!total || total==='â€”') return alert('No result to speak yet.');
      if (!('speechSynthesis' in window)) return alert('Speech synthesis not supported in this browser.');
      const uiLang = document.getElementById('ui-lang').value || 'en-US';
      const utter = new SpeechSynthesisUtterance(`Total is ${total}`);
      utter.lang = uiLang;
      window.speechSynthesis.speak(utter);
    });

    // Translate button placeholder (calls server-side translate)
    document.getElementById('translateBtn').addEventListener('click', ()=> {
      const text = lastTranscript || transcriptEl.textContent || '';
      if (!text) return alert('No transcript to translate.');
      // Placeholder client-side note: In production call your Laravel translate endpoint
      // Example:
      // fetch('/api/translate', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ text, target: 'fr' }) })
      //  .then(r=>r.json()).then(data => { /* show translated text */ });
      alert('Translate action placeholder â€” connect to your /api/translate endpoint.');
    });

    // Send caption placeholder
    document.getElementById('sendCaption').addEventListener('click', ()=> {
      // Here you would push the transcript/translation to meeting overlay via WebSocket or meeting API
      alert('Send to meeting placeholder â€” implement WebSocket / meeting bot to forward captions.');
    });
  </script>
</body>
</html>
